MikuMikuDance/MikuMikuMoving用口パクモーションファイル作成ツール『MikuMikuLipMaker』の使用方法マニュアル。

#contents

*この文書について [#about-page]

この文書では、MikuMikuDance/MikuMikuMoving用口パクモーションファイル作成ツール[[『MikuMikuLipMaker』>ダウンロード#mmd-lipmake]]の使い方を解説します。

現在は下記の環境に基づいて記載しています。

-MikuMikuLipMaker version 1.0.3
-[[MikuMikuMoving>https://sites.google.com/site/mikumikumoving/]] version 1.2.7.2
--[[MikuMikuMovingとの連携>#mmm]]の項で用いたバージョンです。

過去からの更新箇所については[[更新履歴>#history]]を参照してください。

この文書はツール導入済みの環境を前提に記載されています。~
ツールのインストール手順については同梱のreadme.txtを参照してください。

*ツール概要 [#about-tool]

『MikuMikuLipMaker』は、入力文（読み仮名）を基に、MMDモデルを口パクさせるためのモーションファイルを作成するツールです。~
モーションファイルの形式は、MikuMikuDance標準のVMD形式と、MikuMikuMoving標準のMVD形式に対応しています。

[[MikuMikuMoving用プラグイン『口パク＆字幕』>文書/MMM 口パク＆字幕]]の口パク機能を踏襲しており、次のような機能があります。

:漢字や数値を含む入力文を読み仮名に変換|
--「1234」のような数値を「センニヒャクサンジュウヨン」のような読み仮名に変換できます。
--漢字は読み仮名に逆変換しますが、うまく変換できない場合があります。
--英単語は変換できず、アルファベットの羅列として解釈されます。（例：「the」→「ティーエッチイー」）
:プリセット設定による細かなモーフ設定|
--「あ」「い」「う」「え」「お」「閉口」それぞれの口の形を複数モーフの組み合わせで表現できます。

また、次のようなこのツール特有の機能があります。

:ファイル自動命名|
--入力文や現在日時を基にファイル名を自動決定し、ショートカット入力によってサクサクとファイル保存できます。
:入力文＆読み仮名の同時保存|
--モーションファイルの保存時に入力文＆読み仮名をテキストファイルとして同時保存でき、動画編集ツールでの字幕作成等に役立ちます。
:[[MikuMikuMovingとの連携>#mmm]]|
--同梱のプラグインをMikuMikuMovingに導入することで、モーフの表示確認やキーフレームの直接登録が行えます。

*基本的な使い方 [#basic]

+~『MikuMikuLipMaker』を起動し、[[メイン画面>#explain-main]]を開きます。
+~必要に応じて、設定メニューより各種設定を行います。
--詳しくは[[画面説明>#explain]]/[[メニュー>#explain-menu]]/[[「設定」メニュー>#explain-menu-config]]の項を参照してください。
--設定は記憶されるため、前回と同じ設定で利用する場合はこの作業を行う必要はありません。
+~必要に応じて、プリセットの追加や変更を行います。
--詳しくは[[画面説明>#explain]]/[[口パクプリセット編集画面>#explain-preset]]の項を参照してください。
--プリセットは保存されるため、作成済みのプリセットを利用する場合はこの作業を行う必要はありません。
+~入力文の欄に口パクさせたい文章を入力します。
#ref(使い方4_入力文.png,left,nolink,入力文を編集しているところ);
+~自動変換が有効ならば、自動的に読み仮名と口パクデータの欄が更新されるはずです。
#ref(使い方5_読み仮名.png,left,nolink,読み仮名と口パクデータが更新されたところ);
--もし読み仮名が望みのものでなければ、直接編集できます。
--口パクデータは読み仮名から自動的に定まるデータであるため、編集できません。
--自動変換を無効にしている場合は「入力文を読み仮名に変換」ボタンを押すことで更新できます。
+~望みのプリセット、口パクの長さ等を設定します。
#ref(使い方6_各種設定.png,left,nolink,プリセットや長さの設定);
--詳しくは[[画面説明>#explain]]/[[メイン画面>#explain-main]]の項を参照してください。
+~メニューより、モーションファイルへ保存します。~
正常に保存されるとステータスバーの表示が更新されます。
#ref(使い方7_ステータスバー.png,left,nolink,正常保存時のステータスバー表示);
--詳しくは[[画面説明>#explain]]/[[メニュー>#explain-menu]]/[[「ファイル」メニュー>#explain-menu-file]]の項を参照してください。
--自動命名保存を行う場合は @kbd{Ctrl+S}; のショートカット入力が便利です。
+~手順 4 〜 7 を繰り返して、必要なモーションファイルを作成していきます。

なお、作成したVMDファイルをMikuMikuDanceで読み込もうとすると警告ダイアログが表示されますが、構わず読み込んでしまって問題ありません。

*画面説明 [#explain]

**メイン画面 [#explain-main]

『MikuMikuLipMaker』を起動するとこの画面が表示されます。

#ref(メイン画面.png,left,nolink,メイン画面);

:&#9312;メニュー|
--[[メニュー>#explain-menu]]の項を参照してください。
:&#9313;「入力文」テキストボックス|
--読み仮名の基となる文章を入力します。改行も可能です。
--モーションファイル保存と同時に、ここに入力した文章をテキストファイルとして保存するように設定可能です。
:&#9314;「入力文を読み仮名に変換」ボタン|
--「入力文」テキストボックスの内容を読み仮名（カタカナ）に変換して「読み仮名」テキストボックスに設定します。
--「読み仮名」テキストボックスの内容は上書きされます。
:&#9315;「自動変換」チェックボックス|
--チェックを入れた状態だと、「入力文を読み仮名に変換」ボタンを押さずとも、「入力文」テキストボックスの内容が変更されると自動的に「読み仮名」テキストボックスに反映されます。
:&#9316;「読み仮名」テキストボックス|
--口パクモーションの基となる読み仮名をひらがなまたはカタカナで入力します。
--漢字や英数字は「ん」（閉口）と同等の扱いになります。
--「。」や「,」などの文字で少し間を空けることができます。
:&#9317;「口パクデータ」テキストボックス|
--内部で生成された口パクデータを文字列化したものです。
--「読み仮名」テキストボックスの内容が変更されると自動的に更新されます。
--直接書き換えることはできません。
:&#9318;プリセット選択コンボボックス|
--「あ」〜「お」および「閉口」の口形状に対してどのようなモーフを設定するか定めたプリセットを選択します。
--既定では「デフォルト」しかありませんが、[[口パクプリセット編集画面>#explain-preset]]で自由に追加・変更できます。
:&#9319;プリセット「編集」ボタン|
--[[口パクプリセット編集画面>#explain-preset]]を開きます。
:&#9320;長さ種別コンボボックス|
--口パクの長さ設定方法を選択します。
--「1音あたり」を選択した場合、1音分の口パクにかかる時間を設定することになります。
---文字種別や長音などにより長さは前後するため、読み仮名の文字数から総フレーム数を単純計算することはできません。
--「入力文全体で」を選択した場合、読み仮名すべてを読み終えるまでにかかる時間を設定することになります。
---読み仮名の文字数に対して設定時間が短すぎる等、場合によっては超過することもあります。
---既存のボイスデータの長さに合わせて口パクさせたい場合に便利かもしれませんが、1音あたりのフレーム数を均等に割り振るだけであるため、ボイスデータが長いほど口パクとのタイミングがずれやすくなります。
:&#9321;長さ数値アップダウン|
--長さ種別コンボボックスで選択した長さ種別に応じた数値を入力します。
:&#9322;長さ単位コンボボックス|
--長さ数値アップダウンで入力する数値の単位を「フレーム」、「ミリ秒」、「秒」のいずれかから選択します。
:&#9323;「FPS」アップダウン|
--FPS値（1秒あたりのフレーム数）を入力します。
--長さ単位コンボボックスで「フレーム」を選択している場合、この値を実時間の算出に利用します。
--MVD形式のモーションファイルを作成する場合、この値がそのままファイルのFPS値として利用されます。
---MikuMikuMovingのタイムラインFPS設定値と揃えることを推奨します。デフォルトは 30 です。
:&#9324;「詳細設定」プルダウン|
--あまり弄る必要のない細かな設定がまとめられています。よくわからなければそのままで構いません。
--各項目の「？」アイコンにマウスカーソルを合わせることで説明が表示されます。

**メニュー [#explain-menu]

[[メイン画面>#explain-main]]上部のメニューです。

#ref(メニュー.png,left,nolink,メニュー);

-[[ファイル>#explain-menu-file]]
-[[設定>#explain-menu-config]]
-[[送信>#explain-menu-send]]
-[[情報>#explain-menu-info]]

***「ファイル」メニュー [#explain-menu-file]

#ref(メニュー_ファイル.png,left,nolink,ファイルメニュー);

:自動命名保存|
--ファイル名を自動決定してモーションファイルを即座に保存します。
--ファイルの保存先、形式、および名前の決定方法は[[「設定」メニュー>#explain-menu-config]]での設定内容次第です。
:名前を付けて保存...|
--保存先を指定してモーションファイルを保存します。
:終了|
--メイン画面を閉じ、『MikuMikuLipMaker』を終了させます。
--メイン画面タイトルバーの「×」ボタンを押すことと同じです。

***「設定」メニュー [#explain-menu-config]

#ref(メニュー_設定.png,left,nolink,設定メニュー);

:ファイル形式|
#ref(メニュー_設定_ファイル形式.png,left,nolink,設定/ファイル形式メニュー);
--モーションファイルの形式を次のいずれかから選択します。
|~メニュー|~形式|~説明|h
|LEFT:|LEFT:|LEFT:|c
|~MikuMikuDance 標準形式 (*.vmd)|VMD形式|MikuMikuDance標準のモーションファイル形式です。&br;MikuMikuDanceでもMikuMikuMovingでも読み込めます。&br;FPS値は 30 固定です。|
|~MikuMikuMoving 標準形式 (*.mvd)|MVD形式|MikuMikuMoving標準のモーションファイル形式です。&br;MikuMikuDanceでは読み込めません。&br;任意のFPS値で保存できます。|
--自動命名保存時にはここで選択した形式で保存されます。
--名前を付けて保存する際には、ここで選択した形式がファイル保存ダイアログで初期選択された状態になります。
:自動命名形式|
#ref(メニュー_設定_自動命名形式.png,left,nolink,設定/自動命名形式メニュー);
--自動命名保存時のファイル名の付け方を選択します。
--例えば入力文が「長月可愛い」、読み仮名が「ナガツキカワイイ」、保存日時が「2015-10-05 12:34:56」である場合、項目ごとのファイル名は次のようになります。（VMD形式の場合）
|~メニュー|~保存ファイル名|h
|LEFT:|LEFT:|c
|~入力文|長月可愛い.vmd|
|~時刻_入力文|123456_長月可愛い.vmd|
|~日付_時刻_入力文|20151005_123456_長月可愛い.vmd|
|~読み仮名|ナガツキカワイイ.vmd|
|~時刻_読み仮名|123456_ナガツキカワイイ.vmd|
|~日付_時刻_読み仮名|20151005_123456_ナガツキカワイイ.vmd|
|~日付_時刻|20151005_123456.vmd|
--入力文や読み仮名が空欄の場合は ''"(blank)"'' という文字列になります。
--入力文や読み仮名が12文字を超える場合は ''先頭11文字'' + ''"-"'' （ハイフン）という文字列になります。
--ファイル名として使用できない文字は ''"_"'' （アンダーバー）に置換されます。
--既に同じ名前のファイルが存在する場合は拡張子の手前に ''"[1]"'' 等の角カッコ数値文字列が追加されます。
:自動命名保存先...|
--自動命名保存時の保存先フォルダを選択します。
--保存先フォルダが存在しない場合は保存時に作成を試みます。
:テキストを同時保存|
--チェックを付けると、モーションファイルの保存時に入力文と読み仮名が書かれたテキストファイルを同時に保存します。
--ファイル名は ''モーションファイル名'' + ''".txt"'' となります。
--入力文が空欄の場合は読み仮名のみ書き出されます。

***「送信」メニュー [#explain-menu-send]

#ref(メニュー_送信.png,left,nolink,送信メニュー);

-MikuMikuMovingとの連携用メニューです。連携していない状態では何も行いません。
-詳しくは[[MikuMikuMovingとの連携>#mmm]]/[[「送信」メニューで行えること>#mmm-menu]]の項を参照してください。

***「情報」メニュー[#explain-menu-info]

#ref(メニュー_情報.png,left,nolink,情報メニュー);

:Webマニュアル|
--既定のWebブラウザで当文書を表示します。
:バージョン情報...|
--『MikuMikuLipMaker』のバージョン情報ダイアログを表示します。
:ライセンス表記...|
--『MikuMikuLipMaker』が利用しているライブラリのライセンス表記ダイアログを表示します。

**口パクプリセット編集画面 [#explain-preset]

[[メイン画面>#explain-main]]の「プリセット」欄にある「編集」ボタンを押すことで表示される画面です。

#ref(口パクプリセット編集画面.png,left,nolink,口パクプリセット編集画面);

:&#9312;プリセット一覧|
--既存のプリセットの一覧が表示されます。
:&#9313;「削除」ボタン|
--選択中のプリセットを削除します。
:&#9314;「↑」ボタン&br;&#9315;「↓」ボタン|
--選択中のプリセットの一覧内での位置を前後させます。
:&#9316;「編集」ボタン|
--選択中のプリセットの内容を「プリセット名」テキストボックスおよび各モーフ設定タブページに反映させます。
--現在のプリセット名および各モーフ設定は完全に上書きされます。
:&#9317;「適用」ボタン|
--「プリセット名」テキストボックスおよび各モーフ設定ページの内容でプリセット一覧を更新します。
--既存のプリセット内に同じプリセット名が存在する場合、確認後に上書きします。
--新しいプリセット名の場合はプリセットが新規登録されます。
:&#9318;「プリセット名」テキストボックス|
--編集中のプリセットの名前を指定します。
:&#9319;口形状タブ|
--口形状を設定するタブページを選択します。
--口形状は「あ」〜「お」および閉口状態を表す「閉」があります。
:&#9320;モーフ名とウェイト値の一覧|
--タブ選択中の口形状に対してどのようにモーフを付けるかを設定します。
--モーフ名が空欄の設定は無視されます。
:&#9321;「追加」ボタン|
--新しいモーフ設定行を追加します。
:&#9322;「削除」ボタン|
--選択中のモーフ設定行を削除します。
:&#9323;「↑」ボタン&br;&#9324;「↓」ボタン|
--選択中のモーフ設定行の一覧内での位置を前後させます。
:&#9325;「送信して表示確認」ボタン|
--MikuMikuMovingとの連携用ボタンです。連携していない状態では何も行いません。
--詳しくは[[MikuMikuMovingとの連携>#mmm]]/[[口パクプリセット編集画面で行えること>#mmm-preset]]の項を参照してください。
:&#9326;「閉じる」ボタン|
--編集画面を閉じます。
--編集画面タイトルバーの「×」ボタンを押すことと同じです。

*MikuMikuMovingとの連携 [#mmm]

**概要 [#mmm-about]

同梱のMikuMikuMoving用プラグインを導入することで、『MikuMikuLipMaker』からMikuMikuMoving上で選択中のモデルに対して下記の操作を行えます。

-モーフ設定の表示確認
-口パクデータのキーフレーム登録

『MikuMikuLipMaker』本体と同じ場所にある ''mmm_plugin'' フォルダ内の ''ruche.mmm.MikuMikuLipClient.dll'' というファイルを、MikuMikuMoving本体と同じ場所にある ''Plugins'' フォルダ内にコピーすることで導入できます。

**機能利用前に行うべきこと [#mmm-pre]

+~MikuMikuMovingを起動します。
+~「プラグイン」メニューの「MikuMikuLipクライアント」をクリックして有効状態にします。
#ref(MMM_プラグイン有効化.png,left,nolink,プラグインを有効にしたところ);
+~操作対象のモデルをロードし、選択状態にします。
#ref(MMM_モデル選択.png,left,nolink,モデルを選択したところ);
+~キーフレーム登録を行う場合は、キーフレームを登録したい位置にフレームマーカーを移動させます。
#ref(MMM_フレームマーカー移動.png,left,nolink,フレームマーカーを移動したところ);

**「送信」メニューで行えること [#mmm-menu]

[[「送信」メニュー>#explain-menu-send]]からMikuMikuMovingに対して次のことを行えます。

#ref(メニュー_送信.png,left,nolink,送信メニュー);

:口パクデータをキーフレーム登録|
--現在の口パクデータを、MikuMikuMovingのフレームマーカーの位置へ直接キーフレーム登録します。
:キーフレーム登録オプション|
#ref(メニュー_送信_キーフレーム登録オプション.png,left,nolink,送信/キーフレーム登録オプションメニュー);
::モーションの繋ぎを自然にする|
---キーフレーム登録先の現在のモーフ状態から極力自然にモーションが繋がるようにします。
---例えばフレームマーカーの位置における "あ" のモーフのウェイト値が 1 である場合、いきなり 0 にするのではなく滑らかに変化させます。
---モーションの終端にも適用され、モーション終端フレームではキーフレーム登録前の状態に復帰します。
---滑らかに繋ぐ対象となるモーフは、現在選択中のプリセットに含まれているモーフのみです。
::既存キーフレームを削除する|
---キーフレーム登録先範囲にある既存のキーフレームを事前に削除します。
---削除対象となるモーフは、現在選択中のプリセットに含まれているモーフのみです。
:選択プリセットの「…」を表示確認|
--現在選択中のプリセットに設定されている各口形状を表示確認します。
--各モーフのウェイト値を操作するのみで、キーフレーム登録は行いません。
--プリセット内のいずれかの口形状に含まれており、かつ選択した口形状に含まれていないモーフはすべてウェイト値 0 になります。

**口パクプリセット編集画面で行えること [#mmm-preset]

-[[口パクプリセット編集画面>#explain-preset]]にある''「送信して表示確認」ボタン''を押すことで、現在選択中の口形状タブページのモーフ設定を表示確認します。
-各モーフのウェイト値を操作するのみで、キーフレーム登録は行いません。
-いずれかの口形状タブページに含まれており、かつ選択した口形状タブページに含まれていないモーフはすべてウェイト値 0 になります。

*更新履歴 [#history]

:2018-04-09|
--version 1.0.3 を対象とした。
:2015-10-08|
--version 1.0.1 を対象とした。
--作成したVMDファイルをMikuMikuDanceで読み込む際の注意点を追記。
:2015-10-08|
--初版。
